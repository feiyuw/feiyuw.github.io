<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>TA | 张裕的博客</title>
  <meta name="author" content="feiyuw">
  
  <meta name="description" content="Test Automation, Continuous Delivery, Node.js, Python and VIM">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="张裕的博客"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="张裕的博客" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">张裕的博客</a></h1>
  <h2><a href="/">大音希声，大象希行</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">首页</a></li>
    
      <li><a href="/archives">存档</a></li>
    
      <li><a href="/about">关于</a></li>
    
      <li><a href="/atom.xml">RSS</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
<h2 class="archive-title tag">TA</h2>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-07-18T09:08:38.000Z"><a href="/2014/07/18/测试自动化方案的选择/">2014-07-18</a></time>
      
      
  
    <h1 class="title"><a href="/2014/07/18/测试自动化方案的选择/">测试自动化方案的选择</a></h1>
  

    </header>
    <div class="entry">
      
        <p>&emsp;&emsp;软件开发发展到今天，分工已经越来越细了，测试自动化也已成为很多组织所采用的重要测试手段。笔者这几年工作过的公司和组织，见过很多不同的开发和测试模式，以及很多的测试自动化解决方案，很多组织都花费了大量的时间进行测试自动化，但是真正取得良好效果的却不多。大部分的组织在这块都存在或这或那的问题。笔者希望在这里能够抛砖引玉，讨论一下测试自动化方案的选择问题。</p>
<h2 id="测试自动化是什么">测试自动化是什么</h2>
<p>&emsp;&emsp;什么是自动化测试？关于这个问题，我们可以找到很多的解答。百度百科上关于自动化测试的说明为：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre>一般是指软件测试的自动化，软件测试就是在预设条件下运行系统或应用程序，评估运行结果，预先条件应包括正常条件和异常条件。
自动化测试是把以人为驱动的测试行为转化为机器执行的一种过程。
通常，在设计了测试用例并通过评审之后，由测试人员根据测试用例中描述的规程一步步执行测试，得到实际结果与期望结果的比较。
在此过程中，为了节省人力、时间或硬件资源，提高测试效率，便引入了自动化测试的概念。
</pre></td></tr></table></figure>

<p>&emsp;&emsp;从这个说明中，我们可以提炼几个关键词：</p>
<ul>
<li>节省资源</li>
<li>提高效率</li>
</ul>
<p>&emsp;&emsp;但是只有这两个目的吗？测试自动化实际上扩展了我们传统手工测试的边界，比如并发测试，手工的模拟某些情况下是不现实的。另外引入测试自动化，解放了测试的人力，同时也给测试人员提出了新的要求，这反过来往往会影响到我们的组织结构和人员构成，而由于测试自动化的快速反馈的特点，也会影响我们的发布流程和策略，进而影响到整个软件开发流程。因此，笔者认为，测试自动化还有两个重要的目的：</p>
<ul>
<li>提高测试覆盖率</li>
<li>优化工作流程</li>
</ul>
<p>&emsp;&emsp;因此，这里笔者大胆地给出一个定义：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>测试自动化，是在希望优化工作流程，提高工作效率，节省资源的组织里面，在测试这类工作上面所做的改变。
通过引入自动化，不但提高了测试效率和测试覆盖率，也提高了整个软件开发流程的效率。
同时，自动化的引入，也进一步模糊了开发和测试的界限，使敏捷成为可能。
</pre></td></tr></table></figure>

<h2 id="什么时候引入测试自动化">什么时候引入测试自动化</h2>
<p>&emsp;&emsp;在Michael Feathers的大作《Working Effectively with Legacy Code》里面对于开发的方式有两种描述：</p>
<ol>
<li>edit and pray</li>
<li>cover and modify</li>
</ol>
<p>&emsp;&emsp;我们显然不希望选择第一种方式，然而事实是即便在全球顶尖的公司里面，还有相当数量的组织和团队采用这种工作方式。程序员在写完代码的时候不知道他们的代码能不能工作，他们寄希望于独立的测试团队来验证整个产品的功能，以保证交付的质量。在这样的组织里面，可能会有一定程度的单元测试和持续集成，但是TDD（测试驱动开发）这样的模式是一定没有推广起来的。同时由于测试的分离，两个独立的组织间的沟通也是一个问题，甚至还有冲突。</p>
<p>&emsp;&emsp;尽管敏捷已经提出很多年了，我们不得不承认，还有很多的组织在用瀑布模型来进行软件开发，还有很多的管理层坚持测试组织的独立性。因此，作为工作在一线的员工，笔者没有奢望影响到管理层的决策和这么多人的习惯。我们今天就以不同的开发模式和人员组成，来看看什么时候适合引入测试自动化，或者说要不要引入测试自动化。</p>
<h3 id="小团队，没有或很少的测试人员">小团队，没有或很少的测试人员</h3>
<p>&emsp;&emsp;如果是初创的小团队，笔者觉得没有必要有独立的测试职位，这不仅仅是从节约资金上考虑，同时也是为了让所有的开发人员有一种产品意识。经常地去测试自己的产品，才能帮助自己开发出好的产品来。这种情况下，测试的消耗就要求尽可能地小和快了。笔者认为对于比较小的相对独立的项目，充分地单元测试加上少量的手工测试就可以了。如果项目有依赖，或者属于某一个大系统的一个子集，那集成层面的功能性测试就非常必要了，而且当项目变大之后，相关的功能模块越来越多，单元测试往往会无法覆盖某些关键路径。这种情况下，就必须要有全自动化的测试，并且每次代码提交后，只要过了单元测试和编译都去执行它。不能因为人员少或者缺少相关的背景而忽略掉测试，无路项目大小，单元测试都是必须的，而如果可预见的系统功能较多，那自动化功能测试也是必要的。小团队在制定流程上的灵活性，使得他们很容易切换工作模式，这种时候尝试一下TDD或者BDD，将会是非常美妙的一件事情。一旦我们驾驭了TDD和BDD，那我们会发现交付产品不再是一个让人忐忑的事情。</p>
<h3 id="有独立的测试组织的团队">有独立的测试组织的团队</h3>
<p>&emsp;&emsp;这样的团队往往比较大了，或者属于流程比较规范的公司，国内很多外包公司都乐于这么做。当测试组织独立的时候，我们需要避免一种情况的发生，这种情况在笔者工作过的公司见过很多次。当项目初步启动的时候，测试团队往往不知道做什么，他们会利用这段时间阅读需求文档等，但事实上这个时候的需求文档往往会在今后经历很多的变化。而到了项目后期，测试团队的压力变得非常大，他们需要加班加点保证所有的功能都被测试覆盖，没有死角。</p>
<p>&emsp;&emsp;独立的测试组织需要避免上述问题的发生，他们就必须尽早地加入到开发流程中去。笔者认为，最合适的方式，就是以测试用例来验证功能的交付。比如说，第一阶段研发开始，第一个要实现的功能是一个登陆模块，那作为测试组织，必须要在代码开始前就和开发团队确定这个功能的验证用例。然后测试团队需要研究自动化测试策略，选择合适的工具构建测试用例，并且把测试用例和需求文档有机地结合起来。</p>
<p>&emsp;&emsp;笔者认为，独立的测试团队需要尽可能早地建立起来有效的测试框架。当开发开始的时候，测试用例就要同步开始编写了，并且当产品每日构建或者发布的时候就执行全部测试用例，并及时给予反馈。对于自动化测试的执行和反馈周期必须在24小时以内，整个过程必须全自动，并且对于这一类发现问题，测试和研发团队要达成共识，其修复优先级要高于新功能的开发。</p>
<p>&emsp;&emsp;对于测试团队来讲，这个过程中比较难的就是自动化用例的更新和反馈周期，这里需要测试框架的制定者有一定的经验，并经常更新框架和测试用例，对于测试用例的质量也有较高的要求，建议采用类似code review的方式评审用例和框架，并采用gitlab、gerrit等合作方式提高效率。</p>
<p>&emsp;&emsp;如果无法与研发在测试自动化执行和修复的流程上达成一致，就必须要修正策略，减少自动化测试投入，加强手工测试，降低自动化测试频率，如仅仅对研发认为的稳定版本进行测试等等，但一周至少要执行一次，如果连这个频率都保证不了，建议直接放弃自动化测试。</p>
<p>&emsp;&emsp;如果整个测试团队严重缺乏自动化测试或者开发经验，建议在选择自动化测试方案的时候慎重考虑，如果确定有足够的时间来培训团队，有强有力的自动化测试领导者，可以尝试，不然建议放弃。</p>
<h3 id="测试和开发混合的团队">测试和开发混合的团队</h3>
<p>&emsp;&emsp;选择测试和开发混合组建的团队，一般采用敏捷开发的模式，对于测试自动化的接受程度较高。因此对一般的产品和项目来说，测试自动化必然是一开始就要引入的。但是从另一个角度讲，这一类的组织形式也容易产生团队间的重复工作，浪费现象严重。因此建议对于这一类型的组织，在自动化测试框架和策略方面要做到不同团队间的一致，并且不同团队共享同一份测试框架代码。另外建议有相对独立的测试自动化评审团队来验收框架代码和用例，以保证质量。</p>
<p>&emsp;&emsp;对于这一类型的组织，测试用例间的耦合性必须消除，即便是以执行时间为代价。测试用例必须尽可能独立和简洁明了，执行频率需要在所有团队上统一，如每日一次，并且不能收到某个团队的干扰。对于自动化测试发现的问题，所有团队的分析必须及时、高效。</p>
<p>&emsp;&emsp;对于这一类型的组织，建议自动化测试在执行层面上统一，各个团队不去维护执行框架，但是测试用例、测试设备和结果的维护必须由各个团队自己负责。</p>
<p>&emsp;&emsp;建议定期有相应的执行和分析报告发出\（当然最好是自动的\），以保证各个团队的工作重心不发生偏移。</p>
<p>&emsp;&emsp;虽然建议在执行层面统一，但是不意味着需要有独立的自动化测试执行团队来承担这项工作，事实上应当避免出现这样的团队。有这样的团队虽然从管理上可以带来一定的简便，但是会影响分析和测试效率，更大的影响在于让开发团队出现依赖，不再认真维护他们的测试用例。</p>
<h3 id="测试外包的团队">测试外包的团队</h3>
<p>&emsp;&emsp;这类测试一般相对独立和明确，因此什么时候引入，要不要引入测试自动化基本是确定的，关键是可维护性要求较高。笔者工作中曾经遇到一个外包的产品，自动化测试的用例基本是一个模块一种方案，而且由于稳定性问题，验收的标准被定义为在20次连续的测试中有一次可以全部通过即为通过。当后来因为产品线的问题，这个产品取消外包后，接手的团队不得不重新设计自动化测试框架和方案，并把原来的测试用例逐个分析和翻译，耗费了大量的时间。</p>
<p>&emsp;&emsp;如果外包的团队和内部团队在一起工作，那和前面的几个方式的讨论没什么区别；如果外包的团队独立工作，或者属于不同的地区和国家，那尽可能将稳定的回归测试工作外包，并要求外包团队接近100%的测试自动化率，以避免风险。</p>
<h2 id="如何决定测试自动化方案">如何决定测试自动化方案</h2>
<p>&emsp;&emsp;前面我们谈了要不要引入测试自动化，以及什么时候引入测试自动化。接下来我们具体谈一下面对特定的项目，采用什么样的测试自动化方案比较合适。</p>
<h3 id="开发流程决定测试自动化方案">开发流程决定测试自动化方案</h3>
<p>&emsp;&emsp;不同的开发流程对测试自动化方案的选择往往具有决定意义。在选择自动化测试方案前，请先仔细考虑一下，在项目采用的开发流程中，你所采用的方案能否得到大家的支持，能否顺利推行。这里笔者举一个例子来说明。</p>
<p>&emsp;&emsp;笔者目前所在的公司是一个较大的通信企业，通信行业的测试设备极为昂贵，且维护的人力成本较高。对于公司里面的任何一个团队（500人以内）来讲，它都不太可能负责某一个产品线的整个环节，往往是其中的一部分，如操作系统，如通信应用等。在选择自动化测试方案的时候往往就有两种选项：</p>
<ol>
<li>利用真实的设备，搭建接近真实的测试环境，上下游的软件都尽可能地更上其它团队的最新开发进度，然后测试自己所交付的产品在这个环境上的质量。</li>
<li>除了自己的产品外，尽可能地用模拟器，测试尽可能地简单，只覆盖自己开发的部分。</li>
</ol>
<p>&emsp;&emsp;同样地对应与上述两种方案，他们所采用的测试工具也往往会出现分歧。第一种方案往往倾向于集成的测试工具，类似LoadRunner、QTP这样的；第二种方案倾向与轻量化的测试工具，往往采用脚本语言如Python、Bash来构建他们的测试集。而在执行层面上，第一种方案往往会有独立的测试团队和工程师来负责，第二种却不一定。同时第二种方案的执行频率要高于第一种。</p>
<p>&emsp;&emsp;那么什么样的团队会倾向于选择第一种方案呢？从笔者的观察来看，如果这个团队研发和测试界限比较明显，或者有较强的测试团队，特别是系统测试团队，开发流程接近瀑布多余敏捷，那他们通常会选择方案一。相反，则多数会选择方案二。</p>
<h3 id="项目特点决定测试自动化方案">项目特点决定测试自动化方案</h3>
<p>&emsp;&emsp;不存在普遍适用的测试自动化方案，比如，对于B/S应用，在功能测试方面，Selenium就是比RobotFramework更合适的选择。但如果测试的是windows桌面应用，那他们就不合适了。再比如，如果项目是做一个通信服务，那用Python这样的脚本语言自己构建测试框架往往更好。</p>
<h3 id="工程师特点决定测试自动化方案">工程师特点决定测试自动化方案</h3>
<p>&emsp;&emsp;采用工程师熟悉的语言和平台，可以更快地推广，并得到较高质量的自动化测试用例。而如果工程师普遍开发功底较薄，那采用标记语言或者模板语言就比采用一般编程语言更合适，这也就是为什么会出现像<a href="http://robotframework.org" target="_blank" rel="external">RobotFramework</a>这样的框架的原因。笔者见过一个项目，测试自动化采用C++语言编写，而且维护效率不低，原因就是这个团队所有的工程师都精通C++语言，这个时候推广Python或者标记语言可能阻力会更大。</p>
<h2 id="测试自动化的团队组成">测试自动化的团队组成</h2>
<p>&emsp;&emsp;很多组织（无论是小公司，还是跨国公司），很容易犯的错误就是忽视自动化测试核心团队的重要性，随意拼凑人员组成这个团队，如果项目旷日持久，其带来的浪费是相当惊人的。在笔者所在公司，就见过这样的例子，两三年之后，测试自动化用例和脚本出现大量的重复，整个测试自动化脚本库几无复用性可言，测试自动化的执行被限定在特定的机器上，环境配置被几千行冗余的Bash脚本所累，抽取和剥离需要耗费几千个小时甚至更多的人力。而且由于早期策略失误，框架扩展性差，造成测试覆盖率的严重不足，交付的产品质量满足不了客户需求。</p>
<p>&emsp;&emsp;一个测试自动化核心团队可以是虚拟的，也可以是具体的团队，但是规模不应该很大，十个人左右是比较理想的情况。他们不应该负责所有测试用例的编写和维护，而应该着重于测试自动化框架和提高测试自动化开发执行效率方面。这个团队的成员必须具有足够的开发背景，能写出高质量的代码，并且有一定的测试经验，能够针对项目和团队的特点制定合适的测试自动化方案。同时，他们也需要有一定的coaching能力，能够影响广大的测试和研发团队，让他们工作在同一个自动化测试框架中，并且尽可能地避免浪费。</p>
<h2 id="没有最好的方案，只有最合适的方案">没有最好的方案，只有最合适的方案</h2>
<p>&emsp;&emsp;软件开发一直在不断地向前演进，无论是技术，还是工作方式，每个十年都有翻天覆地地变化。我们必须不断地更新自己的经验库，经常审视目前的方案，不断地优化它，改进它，使它成为最适合我们的方案。因为永远没有那个方案是最好的方案，我们只是在寻找当前对我们来说最适合的方案。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  

  <nav id="pagination">
  
  
  <div class="clearfix"></div>
</nav>
</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:feiyuw.github.io">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/家庭/">家庭</a><small>1</small></li>
  
    <li><a href="/categories/持续集成/">持续集成</a><small>2</small></li>
  
    <li><a href="/categories/教育/">教育</a><small>1</small></li>
  
    <li><a href="/categories/旅行/">旅行</a><small>1</small></li>
  
    <li><a href="/categories/测试自动化/">测试自动化</a><small>1</small></li>
  
    <li><a href="/categories/读书/">读书</a><small>2</small></li>
  
    <li><a href="/categories/软件开发/">软件开发</a><small>4</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <li><a href="/tags/Gitlab/">Gitlab</a><small>1</small></li>
  
    <li><a href="/tags/NodeJS/">NodeJS</a><small>1</small></li>
  
    <li><a href="/tags/Ruby-On-Rails/">Ruby On Rails</a><small>1</small></li>
  
    <li><a href="/tags/TA/">TA</a><small>1</small></li>
  
    <li><a href="/tags/VIM/">VIM</a><small>1</small></li>
  
    <li><a href="/tags/git/">git</a><small>1</small></li>
  
    <li><a href="/tags/女儿/">女儿</a><small>1</small></li>
  
    <li><a href="/tags/家庭/">家庭</a><small>1</small></li>
  
    <li><a href="/tags/持续集成/">持续集成</a><small>3</small></li>
  
    <li><a href="/tags/效率/">效率</a><small>1</small></li>
  
    <li><a href="/tags/教育/">教育</a><small>1</small></li>
  
    <li><a href="/tags/数学/">数学</a><small>1</small></li>
  
    <li><a href="/tags/旅行/">旅行</a><small>1</small></li>
  
    <li><a href="/tags/美食/">美食</a><small>1</small></li>
  
    <li><a href="/tags/读书/">读书</a><small>2</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2014 feiyuw
  
</div>
<div class="clearfix"></div></footer>
  <script src="//cdnjscn.b0.upaiyun.com/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


</body>
</html>